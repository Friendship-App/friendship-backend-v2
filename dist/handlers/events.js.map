{"version":3,"sources":["../../src/handlers/events.js"],"names":["getEvents","request","reply","pre","user","id","then","res","events","i","length","date","format","isBefore","params","time","maxParticipants","participants","splice","response","createEvent","payload","event","getEventDetails","eventId","data"],"mappings":";;;;;;;AAAA;;AAKA;;;;;;AAEO,MAAMA,gCAAY,CAACC,OAAD,EAAUC,KAAV,KACvB,yBAAYD,QAAQE,GAAR,CAAYC,IAAZ,CAAiBC,EAA7B,EAAiCC,IAAjC,CAAsCC,OAAO;AAC3C,QAAMC,SAASD,GAAf;AACA,OAAK,IAAIE,IAAID,OAAOE,MAAP,GAAgB,CAA7B,EAAgCD,IAAI,CAAC,CAArC,EAAwCA,GAAxC,EAA6C;AAC3C,QACE,sBAAO,sBAAOD,OAAOC,CAAP,EAAUE,IAAjB,EAAuBC,MAAvB,EAAP,EAAwCC,QAAxC,CAAiDZ,QAAQa,MAAR,CAAeC,IAAhE,KACAP,OAAOC,CAAP,EAAUO,eAAV,IAA6BR,OAAOC,CAAP,EAAUQ,YAFzC,EAGE;AACAT,aAAOU,MAAP,CAAcT,CAAd,EAAiB,CAAjB;AACD;AACF;AACD,SAAOP,MAAMiB,QAAN,CAAeX,MAAf,CAAP;AACD,CAXD,CADK;;AAcA,MAAMY,oCAAc,CAACnB,OAAD,EAAUC,KAAV,KACzB,2BAAcD,QAAQoB,OAAtB,EAA+Bf,IAA/B,CAAoCgB,SAASpB,MAAMiB,QAAN,CAAeG,KAAf,CAA7C,CADK;;AAGA,MAAMC,4CAAkB,CAACtB,OAAD,EAAUC,KAAV,KAC7B,+BAAkBD,QAAQa,MAAR,CAAeU,OAAjC,EAA0CvB,QAAQE,GAAR,CAAYC,IAAZ,CAAiBC,EAA3D,EAA+DC,IAA/D,CAAoEmB,QAClEvB,MAAMiB,QAAN,CAAeM,IAAf,CADF,CADK","file":"events.js","sourcesContent":["import {\n  dbCreateEvent,\n  dbGetEventDetails,\n  dbGetEvents,\n} from '../models/events';\nimport moment from 'moment';\n\nexport const getEvents = (request, reply) =>\n  dbGetEvents(request.pre.user.id).then(res => {\n    const events = res;\n    for (let i = events.length - 1; i > -1; i--) {\n      if (\n        moment(moment(events[i].date).format()).isBefore(request.params.time) ||\n        events[i].maxParticipants <= events[i].participants\n      ) {\n        events.splice(i, 1);\n      }\n    }\n    return reply.response(events);\n  });\n\nexport const createEvent = (request, reply) =>\n  dbCreateEvent(request.payload).then(event => reply.response(event));\n\nexport const getEventDetails = (request, reply) =>\n  dbGetEventDetails(request.params.eventId, request.pre.user.id).then(data =>\n    reply.response(data),\n  );\n"]}