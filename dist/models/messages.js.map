{"version":3,"sources":["../../src/models/messages.js"],"names":["dbUpdateMessages","chatroomId","receiverId","knex","del","from","where","then","dbGetMessages","select","orderBy","dbCreateMessage","fields","insert","returning","data","dbRegisterNewUnreadMessage"],"mappings":";;;;;;;AAAA;;;;;;AAEO,MAAMA,8CAAmB,CAACC,UAAD,EAAaC,UAAb,KAC9BC,eACGC,GADH,GAEGC,IAFH,CAEQ,iBAFR,EAGGC,KAHH,CAGS,EAAEL,UAAF,EAAcC,UAAd,EAHT,EAIGK,IAJH,EADK;;AAOA,MAAMC,wCAAgBP,cAC3BE,eACGM,MADH,GAEGJ,IAFH,CAEQ,UAFR,EAGGC,KAHH,CAGS,EAAEL,UAAF,EAHT,EAIGS,OAJH,CAIW,UAJX,EAIuB,MAJvB,CADK;;AAOA,MAAMC,4CAAkBC,UAAU;AACvC,SAAO,oBAAK,UAAL,EACJC,MADI,CACGD,MADH,EAEJE,SAFI,CAEM,GAFN,EAGJP,IAHI,CAGCQ,QAAQA,KAAK,CAAL,CAHT,CAAP;AAID,CALM;;AAOA,MAAMC,kEAA6BJ,UACxC,oBAAK,iBAAL,EACGC,MADH,CACUD,MADV,EAEGL,IAFH,EADK","file":"messages.js","sourcesContent":["import knex from '../utils/knex';\n\nexport const dbUpdateMessages = (chatroomId, receiverId) =>\n  knex\n    .del()\n    .from('unread_messages')\n    .where({ chatroomId, receiverId })\n    .then();\n\nexport const dbGetMessages = chatroomId =>\n  knex\n    .select()\n    .from('messages')\n    .where({ chatroomId })\n    .orderBy('chatTime', 'desc');\n\nexport const dbCreateMessage = fields => {\n  return knex('messages')\n    .insert(fields)\n    .returning('*')\n    .then(data => data[0]);\n};\n\nexport const dbRegisterNewUnreadMessage = fields =>\n  knex('unread_messages')\n    .insert(fields)\n    .then();\n"]}